<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<style>
body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        
        /* flexible box弹性布局，子元素的float，clear，vertical-align属性失效 */
        /* align-items:center; */
        /* align-items:定义flex容器内项目侧轴（纵轴）方向的对齐方式 */
        /* justify-content: center; */
        /* justify-content:设置弹性盒子元素在主轴（横轴）方向上的对齐方式 */
        min-height: 100vh;
        /* vh:相对于视口的高度，视口被分为100单位的vh */
        background-color: #f3eeea;
        
    }
.outbox{
    display: flex;
    border: 1px solid blue;
}
.Lbox{
    width: 18vmax;
    height: 8vmax;
    border: 1px solid red;
    margin: 1vmax;
    /* padding: 1vmax; */
}
.Mbox{
    width: 8vmax;
    height: 8vmax;
    border: 1px solid red; 
    margin: 1vmax;
    /* padding: 1vmax; */
}
.Sbox{
    width: 3vmax;
    height: 3vmax;
    border: 1px solid red; 
    margin: 1vmax;
    /* padding: 1vmax; */
}
</style>
<body>
    <div class="outbox">
        <div class="Lbox box">

        </div>
        <div id="Mbox" class="Mbox box">

        </div>
        <div class="Sbox box"></div>
        <div class="Sbox box"></div>
        <div class="Sbox box"></div>
        <div class="Sbox box"></div>
    </div>
</body>
<script>
    ;(function(M) {
	var moveDiv = function(el, txt) {
		this.txt = typeof(txt) === "string" ? txt : "cdk";
		this.el = typeof(el) === "string" ? document.getElementById(el) : el;
		// 获取元素和初始值
		var oBox = this.el,
			disX = 0,
			disY = 0;
		// 容器鼠标按下事件
		oBox.onmousedown = function(e) {
			var e = e || window.event;
			//获取按下鼠标到div left  top的距离
			disX = e.clientX - this.offsetLeft;
			disY = e.clientY - this.offsetTop;
			//添加鼠标按下事件
			document.onmousemove = function(e) {
				var e = e || window.event;
				oBox.style.position  = 'absolute';
				oBox.style.left = (e.clientX - disX) + 'px';
				oBox.style.top = (e.clientY - disY) + 'px';
			};
			//添加鼠标抬起事件
			document.onmouseup = function() {
                //清空事件
                oBox.style.position  = '';
                oBox.style.left = '';
				oBox.style.top = '';
				document.onmousemove = null;
				document.onmouseup = null;
			};
			return false;
		};
	}

	window.moveDiv = moveDiv;
})(this)

//moveDiv("Mbox");


var boxer = function(){
    this.len = 0;
    this.list = [];
    this.index = 0;
    this.word = "";
    this.update = function(){

    };
    this.scan = function(str){
        this.word = str;
        this.list =  document.querySelectorAll(str);
        this.len = this.list.length;
        console.log(this.list);
        return this;
    };
    this.addmoveaction = function(){
        for(var i = 0;i<this.len;i++){
            (function(i,that){
                console.log(i);
                var el = that.list[i];
                console.log(el);
                el.onmousedown = function(e) {
                    var e = e || window.event;
                    //获取按下鼠标到div left  top的距离
                    var disX = e.clientX - this.offsetLeft;
                    var disY = e.clientY - this.offsetTop;
                    //添加鼠标按下事件
                    document.onmousemove = function(e) {
                        var e = e || window.event;
                        el.style.position  = 'absolute';
                        el.style.left = (e.clientX - disX) + 'px';
                        el.style.top = (e.clientY - disY) + 'px';
                    };
                    //添加鼠标抬起事件
                    document.onmouseup = function() {
                        //清空事件
                        that.checkposition(el);

                        // el.style.position  = '';
                        // el.style.left = '';
                        // el.style.top = '';
                        document.onmousemove = null;
                        document.onmouseup = null;
                    };
                    return false;
                };
            })(i,this)
        }
    };
    this.checkposition = function(el){
        var computedStyle = getComputedStyle(el);
        var magin = parseInt(computedStyle.margin.substring(0,computedStyle.margin.length-2));
        console.log(magin);
        var clientWidth = el.clientWidth;
        var clientHeight = el.clientHeight;
        var offsetWidth = el.offsetWidth;
        var offsetHeight = el.offsetHeight;
        var offsetTop = el.offsetTop;
        var offsetLeft = el.offsetLeft;
        var index = Math.floor(offsetTop/(offsetHeight+magin*2));
        console.log(index);
        var tmp = offsetTop%(offsetHeight+magin*2);
        if(tmp>(0.5*(offsetHeight+magin*2))){
            index++;
        }
        if(index<0){
            index = 0;
        }
        el.style.top = (index*(offsetHeight+magin*2)) + 'px';
        
        console.log(offsetWidth);
    }
};
var boxer = new boxer();
boxer.scan(".box").addmoveaction();

</script>
</html>